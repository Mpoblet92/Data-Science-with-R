---
title: "Project7_Poblet"
author: "Marcel Poblet"
date: "December 6, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(kernlab)
library(caret)
library(randomForest)
weightLift <- read.csv("weightlift.csv")
```

## Weight Lifting

  We are going to be viewing a data set on improper weight lifting.
  
## Training Options
```{r}
trainOpts <- trainControl()
trainOpts$method="cv"
trainOpts$number=3
```
```{r}
set.seed(519)
inTraining <- createDataPartition(y=weightLift$classe, p=0.25, list=FALSE)
trainingData <- weightLift[inTraining,]
validataionData <- weightLift[-inTraining,]
```

## Train and Build First Model

```{r pressure, echo=FALSE}
rfModel <- train(classe ~ ., data = weightLift, method="rf", trControl=trainOpts, prox=TRUE)
rfModel
```

## Confusion Matrix
```{r}
cm <- confusionMatrix(rfModel$finalModel$predicted,trainingData$classe)
cm$table
```
